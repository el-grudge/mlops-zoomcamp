import importlib
from sklearn.metrics import accuracy_score


def load_class(module_and_class_name):
    parts = module_and_class_name.split('.')
    class_name = parts[-1]
    module_path = '.'.join(parts[:-1])
    module = importlib.import_module(module_path)
    cls = getattr(module, class_name)
    return cls


def train_model(
    model,
    X_train,
    y_train,
    X_val,
    y_val,
    **kwargs,
):
    model.fit(X_train, y_train)

    metrics = None
    y_pred = model.predict(X_val)

    accuracy = accuracy_score(y_val, y_pred)
    metrics = accuracy

    return model, metrics, y_pred